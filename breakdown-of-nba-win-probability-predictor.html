<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" charset="utf-8" content="width=device-width"/>
  <title>Breakdown of NBA Win Probability Predictor</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.4.1/css/bulma.min.css">
    <link rel="stylesheet" href="https://teckhockng.github.io/theme/css/main.9f548f79.css">
    <link rel="stylesheet" href="https://teckhockng.github.io/theme/webassets-external/010418e8be77eba9c979b3618bbf36f4_print.css" media="print">
  <!--[if IE]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
<meta property="og:title" content="Teck Hock NG - Breakdown of NBA Win Probability Predictor">
  <meta property="og:description" content="Here's the breakdown of how the NBA Live Win Probability Predictor Works. You can find the code here @app.py or visit the website here. Firstly, to populate the home page, I used a request to get...">
<meta property="og:url" content="https://teckhockng.github.io/breakdown-of-nba-win-probability-predictor.html">
<meta name="twitter:card" content="summary">
</head>

<style>
.nav.has-shadow{
  visibility: hidden;
}
</style>
<body id="index" class="home">
<header class="hero is-primary">
  <div class="hero-head">
    <div class="container">
      <nav class="nav">
        <div class="nav-left">
          <a class="nav-item is-brand title is-3"
             href="https://teckhockng.github.io/">Teck Hock NG</a>
        </div>
        <div class="nav-right">
              <a class="nav-item is-tab "
                 href="https://teckhockng.github.io/category/visualization.html">Visualization</a>
              <a class="nav-item is-tab "
                 href="https://teckhockng.github.io/category/regressor.html">Regressor</a>
              <a class="nav-item is-tab "
                 href="https://teckhockng.github.io/category/nlp.html">NLP</a>
              <a class="nav-item is-tab "
                 href="https://teckhockng.github.io/category/flask.html">Flask</a>
              <a class="nav-item is-tab is-active"
                 href="https://teckhockng.github.io/category/classifier.html">Classifier</a>
        </div>
      </nav>
    </div>
  </div>
</header>

<nav class="nav has-shadow is-hidden-print">
  <!-- <div class="container">
    <div class="nav-center"></div>
    <span id="navToggle" class="nav-toggle">
      <span></span>
      <span></span>
      <span></span>
    </span>
    <div id="navMenu" class="nav-right">
          <a class="nav-item is-tab "
             href="https://teckhockng.github.io/category/visualization.html">Visualization</a>
          <a class="nav-item is-tab "
             href="https://teckhockng.github.io/category/regressor.html">Regressor</a>
          <a class="nav-item is-tab "
             href="https://teckhockng.github.io/category/nlp.html">NLP</a>
          <a class="nav-item is-tab "
             href="https://teckhockng.github.io/category/flask.html">Flask</a>
          <a class="nav-item is-tab is-active"
             href="https://teckhockng.github.io/category/classifier.html">Classifier</a>
    </div>
  </div> -->
</nav>

<div class="container">
  <div class="section columns">
    <div class="column is-three-quarters-desktop is-two-thirds-tablet">
<section id="content" class="body">
  <article>
    <h1 class="title">
      <a href="https://teckhockng.github.io/breakdown-of-nba-win-probability-predictor.html" rel="bookmark"
         title="Permalink to Breakdown of NBA Win Probability Predictor">Breakdown of NBA Win Probability Predictor</a></h1>
<footer class="post-info">
  <abbr class="published" title="2019-11-11T00:00:00-05:00">
    Published <span class="is-info">Mon 11 November 2019</span>
    in <a href="https://teckhockng.github.io/category/classifier.html">Classifier</a>
  </abbr>

    <p class="author">
      <em>by           <a class="url fn" href="https://teckhockng.github.io/author/teck-hock-ng.html">Teck Hock Ng</a>
</em>
      <span class="tag is-small"><a href="https://teckhockng.github.io/tag/python.html">python</a></span>
    </p>
  
</footer>    <div class="section"><h3>Here's the breakdown of how the NBA Live Win Probability Predictor Works. You can find the code here <a href="https://github.com/teckhockng/capstone">@app.py</a> or visit the website <a href="https://nba-live-win-probability-predictor.ca/">here</a>.</h3>
<p>Firstly, to populate the home page, I used a request to get json data from the NBA website for the games that are happening tonight. Then, store them into a <code>list</code> object and send it for index.html to use.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">home</span><span class="p">():</span>

    <span class="c1"># get the data from nba&#39;s json</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://data.nba.com/data/5s/v2015/json/mobile_teams/nba/2019/scores/00_todays_scores.json&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="c1">#Store the data for each game into a variable</span>
    <span class="n">games</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;gs&#39;</span><span class="p">][</span><span class="s1">&#39;g&#39;</span><span class="p">]</span>
    <span class="n">game_data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">_</span><span class="p">,</span><span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">games</span><span class="p">):</span>
        <span class="n">game_data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;stt&quot;</span><span class="p">],</span><span class="n">_</span><span class="p">,</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;cl&quot;</span><span class="p">],</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;v&quot;</span><span class="p">][</span><span class="s2">&quot;s&quot;</span><span class="p">],</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">][</span><span class="s2">&quot;s&quot;</span><span class="p">],</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;v&quot;</span><span class="p">][</span><span class="s2">&quot;ta&quot;</span><span class="p">],</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">][</span><span class="s2">&quot;ta&quot;</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">flask</span><span class="o">.</span><span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">,</span> <span class="n">game_data</span><span class="o">=</span><span class="n">game_data</span><span class="p">)</span>
</code></pre></div>

<p>My index.html looks like this:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;row&quot;</span><span class="p">&gt;</span>
      {% for time,id,time_remaining,visitor_score,home_score,visitor,home in game_data %}
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;card text-center col-sm-6&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;location.href = &#39;/results/{{ id }}&#39;;&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;padding: 10px;&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;card-header&quot;</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;card-title&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;game_status_{{ id }}&quot;</span><span class="p">&gt;</span>Game Status: {{ time }}<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;card-title&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;game_time_{{ id }}&quot;</span><span class="p">&gt;</span>Time Remaining: {{ time_remaining }}<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;card-body&quot;</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;card-text&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;{{url_for(&#39;static&#39;, filename=&#39;images/&#39;+ visitor|string + &#39;_logo.svg&#39;)}}&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;Team Logo&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">&quot;80&quot;</span> <span class="na">width</span><span class="o">=</span><span class="s">&quot;80&quot;</span><span class="p">&gt;</span>
              VS.
            <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;{{url_for(&#39;static&#39;, filename=&#39;images/&#39;+ home|string + &#39;_logo.svg&#39;)}}&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;Team Logo&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">&quot;80&quot;</span> <span class="na">width</span><span class="o">=</span><span class="s">&quot;80&quot;</span><span class="p">&gt;</span>
          <span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;card-text&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;game_score_{{ id }}&quot;</span><span class="p">&gt;</span>
            Score: {{ visitor_score }} - {{ home_score }}
          <span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
      {% endfor %}
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>

<p>As for the JavaScript I've written for <code>index.html</code>, I called a GET request to an API in the server. The API will return a JSON object which will be parsed into an array that contains the data to update the <code>index.html</code>. The <code>setTimeout(update_data,10000);</code> will make the <code>function update_data</code> rerun every 10 seconds.</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span> <span class="nx">update_data</span><span class="p">(){</span>
 <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="s1">&#39;/get_data&#39;</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">xhReq</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
 <span class="nx">xhReq</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
 <span class="nx">xhReq</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">xhReq</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>

 <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
   <span class="k">if</span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mf">0</span><span class="p">].</span><span class="nx">toString</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&quot;ET&quot;</span><span class="p">)){</span>
     <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;game_status_&quot;</span><span class="o">+</span><span class="nx">i</span><span class="p">.</span><span class="nx">toString</span><span class="p">()).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;Game Time: &quot;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mf">0</span><span class="p">].</span><span class="nx">toString</span><span class="p">();</span>
   <span class="p">}</span><span class="k">else</span><span class="p">{</span>
     <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;game_status_&quot;</span><span class="o">+</span><span class="nx">i</span><span class="p">.</span><span class="nx">toString</span><span class="p">()).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;Game Status: &quot;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mf">0</span><span class="p">].</span><span class="nx">toString</span><span class="p">();</span>
   <span class="p">};</span>

   <span class="k">if</span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mf">2</span><span class="p">]</span> <span class="o">==</span> <span class="kc">null</span><span class="p">){</span>
     <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;game_time_&quot;</span><span class="o">+</span><span class="nx">i</span><span class="p">.</span><span class="nx">toString</span><span class="p">()).</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>
   <span class="p">}</span><span class="k">else</span><span class="p">{</span>
     <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;game_time_&quot;</span><span class="o">+</span><span class="nx">i</span><span class="p">.</span><span class="nx">toString</span><span class="p">()).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;Time Remaining: &quot;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mf">2</span><span class="p">];</span>
   <span class="p">};</span>

   <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;game_score_&quot;</span><span class="o">+</span><span class="nx">i</span><span class="p">.</span><span class="nx">toString</span><span class="p">()).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;Score: &quot;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mf">3</span><span class="p">].</span><span class="nx">toString</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; - &quot;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mf">4</span><span class="p">].</span><span class="nx">toString</span><span class="p">();</span>
 <span class="p">}</span>
 <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">update_data</span><span class="p">,</span> <span class="mf">10000</span><span class="p">);</span>
  <span class="p">};</span>

 <span class="nx">update_data</span><span class="p">();</span>
</code></pre></div>

<p>The <code>json.dumps()</code> is used to parse the <code>list</code> into a <code>String</code> so that JavaScript can parse it into an array. Here's the code to generate API from Flask app:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># API to change home page live</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/get_data&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_json_data</span><span class="p">():</span>
    <span class="c1"># get the data from nba&#39;s json</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://data.nba.com/data/5s/v2015/json/mobile_teams/nba/2019/scores/00_todays_scores.json&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="c1">#Store the data for each game into a variable</span>
    <span class="n">games</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;gs&#39;</span><span class="p">][</span><span class="s1">&#39;g&#39;</span><span class="p">]</span>
    <span class="n">game_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span><span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">games</span><span class="p">):</span>
        <span class="n">game_data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;stt&quot;</span><span class="p">],</span><span class="n">_</span><span class="p">,</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;cl&quot;</span><span class="p">],</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;v&quot;</span><span class="p">][</span><span class="s2">&quot;s&quot;</span><span class="p">],</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">][</span><span class="s2">&quot;s&quot;</span><span class="p">],</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;v&quot;</span><span class="p">][</span><span class="s2">&quot;ta&quot;</span><span class="p">],</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">][</span><span class="s2">&quot;ta&quot;</span><span class="p">]))</span>
    <span class="n">json_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">game_data</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json_data</span>
</code></pre></div>

<h3>As for the steps to generate predictions, here's the breakdown:</h3>
<p>The <code>&lt;int:game_id&gt;</code> is used to reference which game for prediction. The <code>game_id</code> is passed into the function for reference. The regex here used is to find any 2 numbers separated by ":" and the following 2 numbers. These data obtained is used for populating the predictions page and then we will use JavaScript to update the page the same way we update the <code>index.html</code></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Prediction page</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/results/&lt;int:game_id&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="n">game_id</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://data.nba.com/data/5s/v2015/json/mobile_teams/nba/2019/scores/00_todays_scores.json&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="c1">#Store the data for each game into a variable</span>
    <span class="n">game</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;gs&#39;</span><span class="p">][</span><span class="s1">&#39;g&#39;</span><span class="p">][</span><span class="n">game_id</span><span class="p">]</span>
    <span class="n">game_status</span> <span class="o">=</span> <span class="n">game</span><span class="p">[</span><span class="s2">&quot;stt&quot;</span><span class="p">]</span>
    <span class="n">time_remaining</span> <span class="o">=</span> <span class="n">game</span><span class="p">[</span><span class="s2">&quot;cl&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">time_remaining</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">time_remaining</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">time_remaining</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[0-9]{1,2}:[0-9]</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">time_remaining</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">visitor_score</span> <span class="o">=</span> <span class="n">game</span><span class="p">[</span><span class="s2">&quot;v&quot;</span><span class="p">][</span><span class="s2">&quot;s&quot;</span><span class="p">]</span>
    <span class="n">home_score</span> <span class="o">=</span> <span class="n">game</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">][</span><span class="s2">&quot;s&quot;</span><span class="p">]</span>
    <span class="n">visitor</span> <span class="o">=</span> <span class="n">game</span><span class="p">[</span><span class="s2">&quot;v&quot;</span><span class="p">][</span><span class="s2">&quot;ta&quot;</span><span class="p">]</span>
    <span class="n">home</span> <span class="o">=</span> <span class="n">game</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">][</span><span class="s2">&quot;ta&quot;</span><span class="p">]</span>
    <span class="n">game_data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">games</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;gs&#39;</span><span class="p">][</span><span class="s1">&#39;g&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span><span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">games</span><span class="p">):</span>
        <span class="n">game_data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;stt&quot;</span><span class="p">],</span><span class="n">_</span><span class="p">,</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;cl&quot;</span><span class="p">],</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;v&quot;</span><span class="p">][</span><span class="s2">&quot;s&quot;</span><span class="p">],</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">][</span><span class="s2">&quot;s&quot;</span><span class="p">],</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;v&quot;</span><span class="p">][</span><span class="s2">&quot;ta&quot;</span><span class="p">],</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">][</span><span class="s2">&quot;ta&quot;</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">flask</span><span class="o">.</span><span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;game_prediction.html&#39;</span><span class="p">,</span> <span class="n">game_id</span><span class="o">=</span><span class="n">game_id</span><span class="p">,</span> <span class="n">game_status</span><span class="o">=</span><span class="n">game_status</span><span class="p">,</span> <span class="n">time_remaining</span><span class="o">=</span><span class="n">time_remaining</span><span class="p">,</span>
    <span class="n">visitor_score</span><span class="o">=</span><span class="n">visitor_score</span><span class="p">,</span> <span class="n">home_score</span><span class="o">=</span><span class="n">home_score</span><span class="p">,</span> <span class="n">visitor</span><span class="o">=</span><span class="n">visitor</span><span class="p">,</span> <span class="n">home</span><span class="o">=</span><span class="n">home</span><span class="p">,</span> <span class="n">game_data</span><span class="o">=</span><span class="n">game_data</span><span class="p">)</span>
</code></pre></div>

<p>JavaScript is included in the <code>game_prediction.html</code> because Jinja2 reference to object passed from the function above will not work if the JavaScript file is called from another folder. Here's the code for plotting the graph (I used Google Charts to plot the graph):</p>
<div class="highlight"><pre><span></span><code><span class="c1">// for plotting graph</span>
  <span class="nx">google</span><span class="p">.</span><span class="nx">charts</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="s1">&#39;current&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;packages&#39;</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">]});</span>
  <span class="nx">google</span><span class="p">.</span><span class="nx">charts</span><span class="p">.</span><span class="nx">setOnLoadCallback</span><span class="p">(</span><span class="nx">drawChart</span><span class="p">);</span>

<span class="c1">// used to store data for drawChart() function to plot</span>
  <span class="kd">var</span> <span class="nx">tableData</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">50</span><span class="p">,</span> <span class="mf">50</span><span class="p">]]</span>
  <span class="kd">function</span> <span class="nx">drawChart</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">visualization</span><span class="p">.</span><span class="nx">DataTable</span><span class="p">();</span>
    <span class="nx">data</span><span class="p">.</span><span class="nx">addColumn</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="s1">&#39;Minutes Played&#39;</span><span class="p">);</span>
    <span class="nx">data</span><span class="p">.</span><span class="nx">addColumn</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="s1">&#39;{{ home }} Win Probability&#39;</span><span class="p">);</span>
    <span class="nx">data</span><span class="p">.</span><span class="nx">addColumn</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="s1">&#39;{{ visitor }} Win Probability&#39;</span><span class="p">);</span>
    <span class="nx">data</span><span class="p">.</span><span class="nx">addRows</span><span class="p">(</span>
      <span class="nx">tableData</span>
    <span class="p">);</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">chart</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;{{ home }} vs {{ visitor }}&#39;</span><span class="p">,</span>
        <span class="nx">subtitle</span><span class="o">:</span> <span class="s1">&#39;Win Probability&#39;</span>
      <span class="p">},</span>
      <span class="nx">width</span><span class="o">:</span> <span class="mf">900</span><span class="p">,</span>
      <span class="nx">height</span><span class="o">:</span> <span class="mf">500</span><span class="p">,</span>
      <span class="nx">hAxis</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Minutes Played&#39;</span><span class="p">,</span>
        <span class="nx">ticks</span><span class="o">:</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">5</span><span class="p">,</span> <span class="mf">10</span><span class="p">,</span> <span class="mf">15</span><span class="p">,</span> <span class="mf">20</span><span class="p">,</span> <span class="mf">25</span><span class="p">,</span> <span class="mf">30</span><span class="p">,</span> <span class="mf">35</span><span class="p">,</span> <span class="mf">40</span><span class="p">,</span> <span class="mf">45</span><span class="p">,</span> <span class="mf">50</span><span class="p">,</span> <span class="mf">55</span><span class="p">,</span> <span class="mf">60</span><span class="p">,</span> <span class="mf">65</span><span class="p">,</span> <span class="mf">70</span><span class="p">,</span> <span class="mf">75</span><span class="p">]</span>
      <span class="p">},</span>
      <span class="nx">vAxis</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Win Probability&#39;</span><span class="p">,</span>
        <span class="nx">ticks</span><span class="o">:</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">10</span><span class="p">,</span> <span class="mf">20</span><span class="p">,</span> <span class="mf">30</span><span class="p">,</span> <span class="mf">40</span><span class="p">,</span> <span class="mf">50</span><span class="p">,</span> <span class="mf">60</span><span class="p">,</span> <span class="mf">70</span><span class="p">,</span> <span class="mf">80</span><span class="p">,</span> <span class="mf">90</span><span class="p">,</span> <span class="mf">100</span><span class="p">]</span>
      <span class="p">},</span>
      <span class="nx">colors</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;#a52714&#39;</span><span class="p">,</span> <span class="s1">&#39;#097138&#39;</span><span class="p">]</span>
    <span class="p">};</span>
    <span class="c1">//Reference to where you want the graph. In my case: &lt;div id=&quot;chart_div&quot;&gt;&lt;/div&gt;</span>
    <span class="kd">var</span> <span class="nx">chart</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">charts</span><span class="p">.</span><span class="nx">Line</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;chart_div&#39;</span><span class="p">));</span>
    <span class="nx">chart</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="s1">&#39;/get_predictions/{{game_id}}&#39;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">xhReq</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
    <span class="nx">xhReq</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="nx">xhReq</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">json_data</span> <span class="o">=</span> <span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">xhReq</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>

    <span class="c1">//if the game hasn&#39;t start, change game status to game time</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">json_data</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">0</span><span class="p">].</span><span class="nx">toString</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&quot;ET&quot;</span><span class="p">)){</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;game_status&quot;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;Game Time: &quot;</span> <span class="o">+</span> <span class="nx">json_data</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">0</span><span class="p">].</span><span class="nx">toString</span><span class="p">();</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;home_win_percentage&quot;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;{{home}}&quot;</span> <span class="o">+</span> <span class="s2">&quot; Win Percentage: 50%&quot;</span><span class="p">;</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;visitor_win_percentage&quot;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;{{visitor}}&quot;</span> <span class="o">+</span> <span class="s2">&quot; Win Percentage: 50%&quot;</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;game_status&quot;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;Game Status: &quot;</span> <span class="o">+</span> <span class="nx">json_data</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">0</span><span class="p">].</span><span class="nx">toString</span><span class="p">();</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;home_win_percentage&quot;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;{{home}}&quot;</span> <span class="o">+</span> <span class="s2">&quot; Win Percentage: &quot;</span> <span class="o">+</span> <span class="nx">json_data</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">7</span><span class="p">].</span><span class="nx">toString</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;%&quot;</span><span class="p">;</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;visitor_win_percentage&quot;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;{{visitor}}&quot;</span> <span class="o">+</span> <span class="s2">&quot; Win Percentage: &quot;</span> <span class="o">+</span> <span class="nx">json_data</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">8</span><span class="p">].</span><span class="nx">toString</span><span class="p">()</span> <span class="o">+</span><span class="s2">&quot;%&quot;</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">json_data</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="kc">null</span><span class="p">){</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;game_time&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;game_time&quot;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;Time Remaining: &quot;</span> <span class="o">+</span> <span class="nx">json_data</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">1</span><span class="p">].</span><span class="nx">toString</span><span class="p">();</span>
    <span class="p">};</span>

    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;game_score&quot;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;Score: &quot;</span> <span class="o">+</span> <span class="nx">json_data</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">2</span><span class="p">].</span><span class="nx">toString</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; - &quot;</span> <span class="o">+</span> <span class="nx">json_data</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">3</span><span class="p">].</span><span class="nx">toString</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">json_data</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">1</span><span class="p">].</span><span class="nx">toString</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)){</span>
      <span class="nx">tableData</span><span class="p">.</span><span class="nx">push</span><span class="p">([])</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
      <span class="nx">tableData</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span> <span class="nx">json_data</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">6</span><span class="p">],</span> <span class="nx">json_data</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">7</span><span class="p">],</span> <span class="nx">json_data</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">8</span><span class="p">]])</span>
    <span class="p">};</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">drawChart</span><span class="p">,</span> <span class="mf">10000</span><span class="p">);</span>

  <span class="p">};</span>
</code></pre></div>

<p>If you noticed this code <code>var url = '/get_predictions/{{game_id}}';</code>, it is actually for the same purpose that is to call an API except this time the predictions for win probability are included. Here's the code and further breakdown of the code are below:</p>
<p>To use your model for prediction, you have to include these:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;model.h5&#39;</span><span class="p">)</span>
</code></pre></div>

<p>In my case, I have a trained neural network called model.h5</p>
<div class="highlight"><pre><span></span><code><span class="c1"># API to update game data and predictions</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/get_predictions/&lt;int:game_id&gt;&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_win_percentage</span><span class="p">(</span><span class="n">game_id</span><span class="p">):</span>
    <span class="c1"># get the data from nba&#39;s json</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://data.nba.com/data/5s/v2015/json/mobile_teams/nba/2019/scores/00_todays_scores.json&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="c1">#Store the data for each game into a variable</span>
    <span class="n">game</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;gs&#39;</span><span class="p">][</span><span class="s1">&#39;g&#39;</span><span class="p">][</span><span class="n">game_id</span><span class="p">]</span>
    <span class="n">game_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">game_status</span> <span class="o">=</span> <span class="n">game</span><span class="p">[</span><span class="s2">&quot;stt&quot;</span><span class="p">]</span>
    <span class="n">time_remaining</span> <span class="o">=</span> <span class="n">game</span><span class="p">[</span><span class="s2">&quot;cl&quot;</span><span class="p">]</span>

    <span class="c1"># Sometimes the game time(game[&quot;cl&quot;) is not available so I used and if/else to check for it</span>
    <span class="k">if</span> <span class="n">game</span><span class="p">[</span><span class="s2">&quot;cl&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">time_remaining</span> <span class="o">=</span> <span class="s2">&quot;00:00&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">time_remaining</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[0-9]{1,2}:[0-9]</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">time_remaining</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">visitor_score</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">game</span><span class="p">[</span><span class="s2">&quot;v&quot;</span><span class="p">][</span><span class="s2">&quot;s&quot;</span><span class="p">])</span>
    <span class="n">home_score</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">game</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">][</span><span class="s2">&quot;s&quot;</span><span class="p">])</span>

    <span class="c1"># These if statements are the same way I used to extract the time played for each quarter when I&#39;m scraping the data</span>
    <span class="k">if</span> <span class="s2">&quot;1st Qtr&quot;</span> <span class="ow">in</span> <span class="n">game_status</span><span class="p">:</span>
        <span class="n">time_played</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1900</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span> <span class="o">-</span> <span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">time_remaining</span><span class="p">,</span><span class="s1">&#39;%M:%S&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">&quot;2nd Qtr&quot;</span> <span class="ow">in</span> <span class="n">game_status</span><span class="p">:</span>
        <span class="n">time_played</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1900</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span> <span class="o">-</span> <span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">time_remaining</span><span class="p">,</span><span class="s1">&#39;%M:%S&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">&quot;3rd Qtr&quot;</span> <span class="ow">in</span> <span class="n">game_status</span> <span class="p">:</span>
        <span class="n">time_played</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1900</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">36</span><span class="p">)</span> <span class="o">-</span> <span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">time_remaining</span><span class="p">,</span><span class="s1">&#39;%M:%S&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">&quot;4th Qtr&quot;</span> <span class="ow">in</span> <span class="n">game_status</span><span class="p">:</span>
        <span class="n">time_played</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1900</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">48</span><span class="p">)</span> <span class="o">-</span> <span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">time_remaining</span><span class="p">,</span><span class="s1">&#39;%M:%S&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">&quot;OT 1&quot;</span> <span class="ow">in</span> <span class="n">game_status</span><span class="p">:</span>
        <span class="n">time_played</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1900</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">53</span><span class="p">)</span> <span class="o">-</span> <span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">time_remaining</span><span class="p">,</span><span class="s1">&#39;%M:%S&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">&quot;OT 2&quot;</span> <span class="ow">in</span> <span class="n">game_status</span><span class="p">:</span>
        <span class="n">time_played</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1900</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">58</span><span class="p">)</span> <span class="o">-</span> <span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">time_remaining</span><span class="p">,</span><span class="s1">&#39;%M:%S&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">&quot;OT 3&quot;</span> <span class="ow">in</span> <span class="n">game_status</span><span class="p">:</span>
        <span class="n">time_played</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1900</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">time_remaining</span><span class="p">,</span><span class="s1">&#39;%M:%S&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">&quot;OT 4&quot;</span> <span class="ow">in</span> <span class="n">game_status</span><span class="p">:</span>
        <span class="n">time_played</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1900</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="o">-</span> <span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">time_remaining</span><span class="p">,</span><span class="s1">&#39;%M:%S&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">&quot;OT 5&quot;</span> <span class="ow">in</span> <span class="n">game_status</span><span class="p">:</span>
        <span class="n">time_played</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1900</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span> <span class="o">-</span> <span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">time_remaining</span><span class="p">,</span><span class="s1">&#39;%M:%S&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">game_status</span> <span class="o">==</span> <span class="s2">&quot;Halftime&quot;</span><span class="p">:</span>
        <span class="n">time_played</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1900</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span> <span class="o">-</span> <span class="n">DT</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">time_remaining</span><span class="p">,</span><span class="s1">&#39;%M:%S&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">time_played</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">prediction_data</span> <span class="o">=</span> <span class="p">[[</span><span class="n">time_played</span><span class="p">,</span> <span class="n">home_score</span><span class="p">,</span> <span class="n">visitor_score</span><span class="p">]]</span>
    <span class="n">home_win_percentage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">prediction_data</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">visitor_win_percentage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="n">home_win_percentage</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">game_data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">game</span><span class="p">[</span><span class="s2">&quot;stt&quot;</span><span class="p">],</span><span class="n">game</span><span class="p">[</span><span class="s2">&quot;cl&quot;</span><span class="p">],</span><span class="n">game</span><span class="p">[</span><span class="s2">&quot;v&quot;</span><span class="p">][</span><span class="s2">&quot;s&quot;</span><span class="p">],</span><span class="n">game</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">][</span><span class="s2">&quot;s&quot;</span><span class="p">],</span><span class="n">game</span><span class="p">[</span><span class="s2">&quot;v&quot;</span><span class="p">][</span><span class="s2">&quot;ta&quot;</span><span class="p">],</span><span class="n">game</span><span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">][</span><span class="s2">&quot;ta&quot;</span><span class="p">],</span><span class="n">time_played</span><span class="p">,</span><span class="n">home_win_percentage</span><span class="p">,</span><span class="n">visitor_win_percentage</span><span class="p">))</span>
    <span class="n">json_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">game_data</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json_data</span>
</code></pre></div>

<h2>Conclusion</h2>
<p>While doing this project, I've tried to use <code>Celery</code> package to run some background process(update the Frontend) but then I realized it wasn't working the way I want. I also tried to run a <code>get request</code> to the <code>data.nba.com</code> from JavaScript but there's CORS(Cross-origin resource sharing) error because the API isn't from the origin(my server). So, the solution is to make your own API the call it from JavaScript.</p>
<p>Some future improvements to be made to the app is to include team ELO and also find a way to include players that will play in the particular game because a superstar sitting out for the night will affect the predictions greatly!</p></div>

  </article>
</section>
    </div>

    <div class="column is-one-quarter-desktop is-one-third-tablet is-hidden-print">
      <aside class="menu">
          <p class="menu-label">Links</p>
          <ul class="menu-list">
              <li><a href="https://nba-live-win-probability-predictor.ca/">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text">NBA Win Probability Predictor</span>
              </a></li>
              <li><a href="https://ted-talk-viral-predictor.herokuapp.com/">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text">TED Talk Virality Predictor Hackathon</span>
              </a></li>
              <li><a href="https://world-happiness-ranking.herokuapp.com/">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text">World Happiness Ranking App</span>
              </a></li>
          </ul>
<p class="menu-label">Social</p>
<ul class="menu-list">
    <li><a href="https://www.linkedin.com/in/teckhockng/">
      <span class="icon is-small">
          <i class="fa fa-linkedin fa-fw"></i>
      </span>
      <span class="link-text">LinkedIn</span>
    </a></li>
    <li><a href="https://github.com/teckhockng">
      <span class="icon is-small">
          <i class="fa fa-github fa-fw"></i>
      </span>
      <span class="link-text">GitHub</span>
    </a></li>
</ul>      </aside>
    </div>
  </div>
</div>

<footer class="footer">
  <div class="container has-text-centered">
    <p><span class="icon is-small"><i class="fa fa-html5"></i></span> HTML 5
      | <span class="icon is-small"><i class="fa fa-css3"></i></span> CSS 3
    </p>
  </div>
</footer>

<script type="text/javascript">
  document.getElementById('navToggle').addEventListener('click', function () {
    var nav = document.getElementById('navMenu');
    var className = nav.getAttribute('class');
    if (className == 'nav-right nav-menu') {
      nav.className = 'nav-right nav-menu is-active';
    } else {
      nav.className = 'nav-right nav-menu';
    }
  });
</script>
</body>
</html>