<!DOCTYPE html>
<html lang="en">
<head>
 <title>How to use Dummy Regressor and Dummy Classifier
</title>
 <!-- Latest compiled and minified CSS -->
 <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
 <div class="container">
  <h1><a href="https://teckhockng.github.io/blog">blog</a></h1>
 </div>
<style>
.vega-actions a {
    margin-right: 12px;
    color: #757575;
    font-weight: normal;
    font-size: 13px;
}
.error {
    color: red;
}
</style>
<script src="https://cdn.jsdelivr.net/npm//vega@3.3.1"></script>
<script src="https://cdn.jsdelivr.net/npm//vega-lite@2.4.3"></script>
<script src="https://cdn.jsdelivr.net/npm//vega-embed@3.11"></script>
</head>
<body>
 <div class="container">
<div class="row">
 <div class="col-md-8">
  <h3>How to use Dummy Regressor and Dummy Classifier</h3>
  <label>2019-09-29</label>
  <h1>How to use Dummy Regressor and Dummy Classifier</h1>
<h2>Dummy Regressor</h2>
<p>There are 4 strategies we can use to as a predictor for the Dummy Regressor. <br>
<li> Mean(default) - Always use the mean of y_train as the prediction </li>
<li> Median - Always use the median of y_train as the prediction </li>
<li> Quantile - Use the y_train value of the percentile specified </li>
<li> Constant - Only use the constant specified as the prediction </li></p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="kn">as</span> <span class="nn">alt</span>
<span class="n">alt</span><span class="o">.</span><span class="n">renderers</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="s1">&#39;notebook&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.dummy</span> <span class="kn">import</span> <span class="n">DummyClassifier</span><span class="p">,</span> <span class="n">DummyRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span><span class="p">,</span> <span class="n">make_regression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Create a simple regression problem</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_regression</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">n_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">n_informative</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">n_targets</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">bias</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
    <span class="n">effective_rank</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">tail_strength</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">noise</span><span class="o">=</span><span class="mf">155.0</span>
<span class="p">)</span>

<span class="c1"># Train test split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Create percentile of y_train dataframe for chart to display</span>
<span class="n">y_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">perc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">y_val</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">101</span><span class="p">):</span>
    <span class="n">y_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y_sort</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">perc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">plot_y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y_val</span><span class="p">,</span>
    <span class="s1">&#39;percentile&#39;</span><span class="p">:</span> <span class="n">perc</span>
<span class="p">})</span>
</pre></div>


<h3>Mean</h3>
<div class="highlight"><pre><span></span><span class="n">dummy_mean</span> <span class="o">=</span> <span class="n">DummyRegressor</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>

<span class="n">dummy_mean</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">dummy_mean</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="k">[14.55126695 14.55126695 14.55126695]</span>
<span class="na">14.551266954042632</span>
</pre></div>


<h3>Constant</h3>
<div class="highlight"><pre><span></span><span class="n">dummy_constant</span> <span class="o">=</span> <span class="n">DummyRegressor</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">dummy_constant</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">dummy_constant</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span><span class="p">]</span>
</pre></div>


<h3>Median</h3>
<div class="highlight"><pre><span></span><span class="n">dummy_median</span> <span class="o">=</span> <span class="n">DummyRegressor</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">)</span>

<span class="n">dummy_median</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">dummy_median</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">400</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">y_train</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="k">[14.57561847 14.57561847 14.57561847]</span>
<span class="na">14.575618468552392</span>
</pre></div>


<h3>Quantile</h3>
<div class="highlight"><pre><span></span><span class="n">dummy_quantile</span> <span class="o">=</span> <span class="n">DummyRegressor</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;quantile&#39;</span><span class="p">,</span> <span class="n">quantile</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>

<span class="n">dummy_quantile</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">dummy_quantile</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100000</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="mi">75</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="k">[135.43852133 135.43852133 135.43852133]</span>
<span class="na">135.43852133253466</span>
</pre></div>


<h4>We can use the chart below to see the value of  prediction according to the quantile specified.</h4>
<h4>strategy='median' is the same as quantile=0.5</h4>
<div class="highlight"><pre><span></span><span class="c1"># Create a selection that chooses the nearest point &amp; selects based on x-axis value</span>
<span class="n">base</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">plot_y</span><span class="p">)</span>

<span class="n">nearest</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">nearest</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                        <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">empty</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="n">bar</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;percentile&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y&#39;</span>
<span class="p">)</span>

<span class="n">selectors</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;percentile:Q&#39;</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">nearest</span>
<span class="p">)</span>

<span class="c1"># Draw points on the line, and highlight based on selection</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">bar</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">nearest</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Draw text labels near the points, and highlight based on selection</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">bar</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">text</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">nearest</span><span class="p">,</span> <span class="s1">&#39;percentile:Q&#39;</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">text2</span> <span class="o">=</span> <span class="n">bar</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dy</span><span class="o">=-</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">text</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">nearest</span><span class="p">,</span> <span class="s1">&#39;y:Q&#39;</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Draw a rule at the location of the selection</span>
<span class="n">rules</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;percentile:Q&#39;</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
    <span class="n">nearest</span>
<span class="p">)</span>

<span class="c1"># Put the five layers into a chart and bind the data</span>
<span class="n">alt</span><span class="o">.</span><span class="n">layer</span><span class="p">(</span>
    <span class="n">bar</span><span class="p">,</span> <span class="n">selectors</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">text2</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Percentile of y_train values&quot;</span>
<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">vega</span><span class="p">.</span><span class="n">vegalite</span><span class="p">.</span><span class="n">VegaLite</span> <span class="k">at</span> <span class="mi">0</span><span class="n">x7ff33fecec18</span><span class="o">&gt;</span>
</pre></div>


<div id="vis"></div>

<script>
  (function(vegaEmbed) {
    var spec = {"config": {"view": {"width": 400, "height": 300}, "mark": {"tooltip": null}}, "layer": [{"mark": "bar", "encoding": {"x": {"type": "quantitative", "field": "percentile"}, "y": {"type": "quantitative", "field": "y"}}}, {"mark": "point", "encoding": {"opacity": {"value": 0}, "x": {"type": "quantitative", "field": "percentile"}}, "selection": {"selector003": {"type": "single", "nearest": true, "on": "mouseover", "fields": ["y"], "empty": "none"}}}, {"mark": "point", "encoding": {"opacity": {"condition": {"value": 1, "selection": "selector003"}, "value": 0}, "x": {"type": "quantitative", "field": "percentile"}, "y": {"type": "quantitative", "field": "y"}}}, {"mark": {"type": "rule", "color": "red"}, "encoding": {"x": {"type": "quantitative", "field": "percentile"}}, "transform": [{"filter": {"selection": "selector003"}}]}, {"mark": {"type": "text", "align": "left", "dx": 5, "dy": 0}, "encoding": {"text": {"condition": {"type": "quantitative", "field": "percentile", "selection": "selector003"}, "value": " "}, "x": {"type": "quantitative", "field": "percentile"}, "y": {"type": "quantitative", "field": "y"}}}, {"mark": {"type": "text", "align": "left", "dx": 5, "dy": -10}, "encoding": {"text": {"condition": {"type": "quantitative", "field": "y", "selection": "selector003"}, "value": " "}, "x": {"type": "quantitative", "field": "percentile"}, "y": {"type": "quantitative", "field": "y"}}}], "data": {"name": "data-589c8009bd1032acf6c3fa2e860ade11"}, "height": 600, "title": "Percentile of y_train values", "width": 600, "$schema": "https://vega.github.io/schema/vega-lite/v3.4.0.json", "datasets": {"data-589c8009bd1032acf6c3fa2e860ade11": [{"y": -835.018071493274, "percentile": 0}, {"y": -444.83823646552, "percentile": 1}, {"y": -363.3886505275625, "percentile": 2}, {"y": -340.13261772541864, "percentile": 3}, {"y": -308.54151792979076, "percentile": 4}, {"y": -282.8571006987326, "percentile": 5}, {"y": -258.2682562559114, "percentile": 6}, {"y": -252.57614139095102, "percentile": 7}, {"y": -247.6628018177709, "percentile": 8}, {"y": -241.67992060310775, "percentile": 9}, {"y": -227.7402897303325, "percentile": 10}, {"y": -216.87865611723595, "percentile": 11}, {"y": -214.36028119122957, "percentile": 12}, {"y": -204.1143076422381, "percentile": 13}, {"y": -187.18952807759686, "percentile": 14}, {"y": -170.54037671160953, "percentile": 15}, {"y": -163.05447886448047, "percentile": 16}, {"y": -155.4614553449076, "percentile": 17}, {"y": -151.55855865927654, "percentile": 18}, {"y": -144.89623543628028, "percentile": 19}, {"y": -138.75429456707442, "percentile": 20}, {"y": -134.1087335158439, "percentile": 21}, {"y": -127.43482918223924, "percentile": 22}, {"y": -120.23061569971266, "percentile": 23}, {"y": -111.79755697988983, "percentile": 24}, {"y": -101.50524308625384, "percentile": 25}, {"y": -92.70649677811616, "percentile": 26}, {"y": -88.38990107709756, "percentile": 27}, {"y": -79.03705317533408, "percentile": 28}, {"y": -74.73672458832394, "percentile": 29}, {"y": -67.99230490004527, "percentile": 30}, {"y": -63.814393030110736, "percentile": 31}, {"y": -60.740325154198885, "percentile": 32}, {"y": -56.07157187097297, "percentile": 33}, {"y": -48.53265858329275, "percentile": 34}, {"y": -45.981398293498664, "percentile": 35}, {"y": -42.39723763952238, "percentile": 36}, {"y": -36.97761712925085, "percentile": 37}, {"y": -33.26452232646075, "percentile": 38}, {"y": -31.911420870058702, "percentile": 39}, {"y": -28.20075968640002, "percentile": 40}, {"y": -21.71192215969929, "percentile": 41}, {"y": -20.613811369098432, "percentile": 42}, {"y": -15.769485333543091, "percentile": 43}, {"y": -13.435908346501137, "percentile": 44}, {"y": -7.845757682422691, "percentile": 45}, {"y": -4.274909675082899, "percentile": 46}, {"y": -0.3074004978537239, "percentile": 47}, {"y": 2.788385337913249, "percentile": 48}, {"y": 6.728667500764336, "percentile": 49}, {"y": 14.575618468552392, "percentile": 50}, {"y": 16.520205067812604, "percentile": 51}, {"y": 19.436020392895152, "percentile": 52}, {"y": 25.47180493152756, "percentile": 53}, {"y": 34.42985406425026, "percentile": 54}, {"y": 38.48102281322768, "percentile": 55}, {"y": 41.67449078991093, "percentile": 56}, {"y": 46.65879274249497, "percentile": 57}, {"y": 48.49049304230679, "percentile": 58}, {"y": 55.11450020183062, "percentile": 59}, {"y": 57.55704217447, "percentile": 60}, {"y": 61.9167307326847, "percentile": 61}, {"y": 67.7972860501853, "percentile": 62}, {"y": 74.86056713548781, "percentile": 63}, {"y": 78.28336134349712, "percentile": 64}, {"y": 90.05277287891795, "percentile": 65}, {"y": 92.65603782901759, "percentile": 66}, {"y": 99.31266688862766, "percentile": 67}, {"y": 101.10647390741705, "percentile": 68}, {"y": 102.19948053284466, "percentile": 69}, {"y": 111.85747243526058, "percentile": 70}, {"y": 120.88047946652841, "percentile": 71}, {"y": 122.42949795432479, "percentile": 72}, {"y": 127.64771726254492, "percentile": 73}, {"y": 131.74726411945286, "percentile": 74}, {"y": 135.43852133253466, "percentile": 75}, {"y": 139.15043901201068, "percentile": 76}, {"y": 140.56649199146744, "percentile": 77}, {"y": 144.97815036149007, "percentile": 78}, {"y": 156.09722114688284, "percentile": 79}, {"y": 161.9680367390797, "percentile": 80}, {"y": 168.05877291160894, "percentile": 81}, {"y": 174.0234819237287, "percentile": 82}, {"y": 176.17602735053197, "percentile": 83}, {"y": 183.60001089849922, "percentile": 84}, {"y": 189.54519567362985, "percentile": 85}, {"y": 197.1004610848934, "percentile": 86}, {"y": 209.30885091639664, "percentile": 87}, {"y": 214.57999310933724, "percentile": 88}, {"y": 219.21003558091812, "percentile": 89}, {"y": 226.4055149463644, "percentile": 90}, {"y": 251.63664457942005, "percentile": 91}, {"y": 261.79776887850085, "percentile": 92}, {"y": 292.9073422122388, "percentile": 93}, {"y": 310.27943509990195, "percentile": 94}, {"y": 342.82672465408746, "percentile": 95}, {"y": 384.57953214295935, "percentile": 96}, {"y": 398.5356115522994, "percentile": 97}, {"y": 431.1703567571817, "percentile": 98}, {"y": 459.4642261422396, "percentile": 99}, {"y": 635.4261652802663, "percentile": 100}]}};
    var embedOpt = {"mode": "vega-lite"};

    function showError(el, error){
        el.innerHTML = ('<div class="error" style="color:red;">'
                        + '<p>JavaScript Error: ' + error.message + '</p>'
                        + "<p>This usually means there's a typo in your chart specification. "
                        + "See the javascript console for the full traceback.</p>"
                        + '</div>');
        throw error;
    }
    const el = document.getElementById('vis');
    vegaEmbed("#vis", spec, embedOpt)
      .catch(error => showError(el, error));
  })(vegaEmbed);

</script>

<h2>Dummy Classifier</h2>
<p>There are 5 strategies we can use to as a predictor for the Dummy Regressor. <br>
<li> Stratified(Default) - Generates predictions based on the y_train's distribution </li>
<li> Most_frequent - Always use the mode of y_train as the prediction </li>
<li> Prior - Always predict the class that maximizes the y_train (like "most_frequent") </li>
<li> Uniform - Generates predictions uniformly at random </li>
<li> Constant - Always predicts a constant label that is provided by the user. This is useful for metrics that evaluate a non-majority class </li></p>
<p>Observe the probability of each prediction of each model. (Probability of 0.5 or above will make the prediction for the variable to be True)</p>
<div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Create a simple classifier problem</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">n_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">n_informative</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">n_redundant</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>

<span class="c1"># Train test split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>


<h3>Stratified</h3>
<div class="highlight"><pre><span></span><span class="n">dummy_stratified</span> <span class="o">=</span> <span class="n">DummyClassifier</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;stratified&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">dummy_stratified</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">dummy_stratified</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">prob</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3>Most_frequent</h3>
<div class="highlight"><pre><span></span><span class="n">dummy_mostfreq</span> <span class="o">=</span> <span class="n">DummyClassifier</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;most_frequent&#39;</span><span class="p">)</span>

<span class="n">dummy_mostfreq</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">dummy_mostfreq</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">prob</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3>Prior</h3>
<div class="highlight"><pre><span></span><span class="n">dummy_prior</span> <span class="o">=</span> <span class="n">DummyClassifier</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;prior&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">dummy_prior</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">dummy_prior</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">prob</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.514925</td>
      <td>0.485075</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.514925</td>
      <td>0.485075</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.514925</td>
      <td>0.485075</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.514925</td>
      <td>0.485075</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.514925</td>
      <td>0.485075</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.514925</td>
      <td>0.485075</td>
    </tr>
  </tbody>
</table>
</div>

<h3>Uniform</h3>
<div class="highlight"><pre><span></span><span class="n">dummy_uniform</span> <span class="o">=</span> <span class="n">DummyClassifier</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">dummy_uniform</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">dummy_uniform</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">prob</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.5</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.5</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.5</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.5</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.5</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.5</td>
      <td>0.5</td>
    </tr>
  </tbody>
</table>
</div>

<h3>Constant</h3>
<div class="highlight"><pre><span></span><span class="n">dummy_constant</span> <span class="o">=</span> <span class="n">DummyClassifier</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">dummy_constant</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">dummy_constant</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">prob</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>Dummy with a constant variable is a good baseline model for us to predict something that is a non-majority class because we can always predict the majority class and get a good score. So, we have to beat the baseline score of the dummy model to make sure our model is picking-up/identified something or else I might as well use the dummy model ðŸ˜„</p>
<h3>Example</h3>
<div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Create a simple classification problem</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">n_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>

<span class="c1">#Modified y values</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span>              <span class="c1">#90% - 0</span>
<span class="n">y</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span> <span class="mi">20</span><span class="p">)</span>          <span class="c1">#10% - 1</span>

<span class="c1"># Train test split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="n">logreg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">)</span>
<span class="n">logreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Logistic Regression has mean accuracy of {logreg.score(X_test, y_test)}.&quot;</span><span class="p">)</span>

<span class="n">dummy_constant</span> <span class="o">=</span> <span class="n">DummyClassifier</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dummy_constant</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Dummy Classifier has mean accuracy of {dummy_constant.score(X_test, y_test)}.&quot;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">Logistic</span> <span class="n">Regression</span> <span class="n">has</span> <span class="n">mean</span> <span class="n">accuracy</span> <span class="k">of</span> <span class="mi">0</span><span class="p">.</span><span class="mi">9393939393939394</span><span class="p">.</span>
<span class="n">Dummy</span> <span class="n">Classifier</span> <span class="n">has</span> <span class="n">mean</span> <span class="n">accuracy</span> <span class="k">of</span> <span class="mi">0</span><span class="p">.</span><span class="mi">9393939393939394</span><span class="p">.</span>
</pre></div>


<h2>Conclusion</h2>
<p>Dummy regressor and classifier with a good hyperparameter can be a good baseline model for your model compare with. If your model can't beat a naive model, then you have to tune your model more or use another model for the problem.</p>
 </div>
</div>
 </div>
</body>
</html>